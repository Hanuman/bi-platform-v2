<html>
<head>
<title>package.html</title>
</head>
<body>
<h1>Notes</h1>

<h2>Division of labor</h2>

<p>
Reading and writing of files is separated from reading and writing of ACLs because the former can be accomplished using
the pure JCR API. The latter sometimes (and does in this implementation) require access to repository-specific (e.g.
Jackrabbit) APIs. Moving to eXo or Alfresco would only entail changing the ACL read/write code.
</p>

<h2>Custom privileges</h2>

<p>
It is not trivial to implement custom privileges (e.g. EXECUTE) in Jackrabbit. See 
<a href="http://issues.apache.org/jira/browse/JCR-2446">JCR-2446</a>. EXECUTE is a somewhat poor example in that
Jackrabbit would never enforce EXECUTE on a file. Jackrabbit cannot know what a user will do with a node. However,
Jackrabbit could enforce EXECUTE on a folder. In Unix, EXECUTE on a folder governs folder traversal. But going back to
EXECUTE on a file, even though Jackrabbit won't enforce EXECUTE on a file, it should be able to read and write the 
EXECUTE privilege to access control entries. As of today, custom privilege registration is not trivial.
</p>

<h2>Node ownership</h2>

<p>
Node ownership is an access control issue. In other words, getting the owner should be governed by the 
READ_ACCESS_CONTROL privilege. Similarly, setting the owner should be governed by the MODIFY_ACCESS_CONTROL privilege.
To enforce this privilege, you must go through the access control API. A custom property on a node that represents the 
owner could be read with merely the READ privilege. Similary, that property could be written with merely the 
MODIFY_PROPERTIES privilege. Therefore, using a custom property is insufficient.
</p>

<h2>Explicit ACE inheritance</h2>

<p>
In addition to node ownership, Jackrabbit's ACL type was extended to provide an explicit "inherit" flag. If set to true,
entries are inherited from the first ancestor whose "inherit" flag is false. This explicit flag is considered more 
desirable than a convention such as, "any ACL with no ACEs should inherit." 
</p>

<h2>Pathing</h2>

<p>
The implementation is intentionally unaware of any folder paths. For example, it doesn't know what a tenant root folder
is. For one, this keeps pathing (which should be customizable) out of the core.
</p>

<h2>Locking</h2>

<p>
In this implementation, all locks are open-scoped.  That's because sessions are short-lived. Therefore it is necessary
to persist lock tokens for retrieval from subsequent sessions. See section 8.4.7 of the JSR-170.
</p>

<p>
JCR locking was extended to add "message" (aka "comment") and "date" properties in addition to "lock owner."
</p>

<h2>Versioning</h2>

<p>
JCR versioning was extended to add "message" (aka "comment") and "author" properties.
</p>

<h2>Localization</h2>

<p>
All Pentaho file and folder nodes can have localizable properties. Examples are title and description.
</p>
</body>
</html>