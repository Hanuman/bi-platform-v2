<!-- ============================================================
     description: main build file for BI Platform Engine
-->

<project name="bi-platform-web">
	<!-- ================================================================
		PROPERTIES
		
		Do not add properties to this file. All properties are defined 
		in the build.properites file. If you need to override a property
		that is in the build.properites file, use an override.properties file.
    ===================================================================== -->

	<property file="override.properties" />
	<property file="build_coverage.properties" />
	<tstamp>
		<format property="current.date" pattern="yyyyMMdd-hh:mma" locale="en" />
	</tstamp>
	<target name="init" description="create timestamp and directories">
		<tstamp />
		<mkdir dir="${coverage.report.dir}" />
	</target>
	<target name="clean" description="delete directories">
		<tstamp />
		<delete dir="${coverage.report.dir}" />
	</target>
	<!-- ===================================================================
        target: run-all-reports
        
        Executes all the coverage report formats
    =================================================================== -->

	<target name="run-all-reports" depends="run-web-reports, run-portlet-reports, run-servlet-reports"/>
	
	<!-- ===================================================================
        target: clean-all-tests
        
        Cleans all the folders created for unit testing and coverage for all
        sub projects
    =================================================================== -->	
	<target name="clean-all-tests" depends="clean-web, clean-portlet, clean-servlet"/>
	<!-- ===================================================================
        target: clean-web
        
        Cleans all the folders created for unit testing and coverage for web
        project
    =================================================================== -->
	<target name="clean-web">
		<ant antfile="build_coverage.xml" dir="projects/web" target="clean-test"/>
	</target>
	<!-- ===================================================================
        target: clean-portlet
        
        Cleans all the folders created for unit testing and coverage for portlet
        project
    =================================================================== -->
	<target name="clean-portlet">
		<ant antfile="build_coverage.xml" dir="projects/portlet" target="clean-test"/>
	</target>	
	<!-- ===================================================================
        target: clean-servlet
        
        Cleans all the folders created for unit testing and coverage for servlet
        project
    =================================================================== -->
	<target name="clean-servlet">
		<ant antfile="build_coverage.xml" dir="projects/servlet" target="clean-test"/>
	</target>			
	<target name="copy-all-reports" depends="copy-web-reports, copy-portlet-reports, copy-servlet-reports"/>

	<!-- ===================================================================
        target: run-web-reports
        
        Executes the web reports by passing the specific parameters
    =================================================================== -->	
	<target name="run-web-reports">
		<ant antfile="build_coverage.xml" dir="projects/web" target="all-coverage-report"/>
	</target>
	<!-- ===================================================================
        target: run-portlet-reports
        
        Executes the portlet reports by passing the specific parameters
    =================================================================== -->	
	<target name="run-portlet-reports">
		<ant antfile="build_coverage.xml" dir="projects/portlet" target="all-coverage-report"/>
	</target>		
	<!-- ===================================================================
        target: run-servlet-reports
        
        Executes the servlet reports by passing the specific parameters
    =================================================================== -->	
	<target name="run-servlet-reports">
		<ant antfile="build_coverage.xml" dir="projects/servlet" target="all-coverage-report"/>
	</target>
	<target name="copy-web-reports" depends="init, run-web-reports" >
		<copy todir="${coverage.report.dir}" >
			<fileset dir="${bi-platform-web-web.report.dir}" />
		</copy>
	</target>
	<target name="copy-portlet-reports" depends="init, run-portlet-reports">
		<copy todir="${coverage.report.dir}" >
			<fileset dir="${bi-platform-web-portlet.report.dir}" />
		</copy>
	</target>
	<target name="copy-servlet-reports" depends="init, run-servlet-reports" >
		<copy todir="${coverage.report.dir}" >
			<fileset dir="${bi-platform-web-servlet.report.dir}" />
		</copy>
	</target>
</project>